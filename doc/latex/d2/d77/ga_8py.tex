\hypertarget{ga_8py}{}\doxysection{examples/knapsack-\/ga/util/ga.py File Reference}
\label{ga_8py}\index{examples/knapsack-\/ga/util/ga.py@{examples/knapsack-\/ga/util/ga.py}}


libqrng -\/ library for interacting with IDQ\textquotesingle{}s Quantis Appliance \# \# Copyright (C) 2023 Sebastian Mihai Ardelean \# \# This program is free software\+: you can redistribute it and/or modify \# it under the terms of the GNU General Public License as published by \# the Free Software Foundation, either version 3 of the License, or \# (at your option) any later version.  


\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{ga_8py_a990506680594f152efd0acda3b61a8ce}{ga.\+run}} (chromosome\+\_\+size, gene\+\_\+low, gene\+\_\+high, population\+\_\+size, mutation\+\_\+rate, crossover\+\_\+rate, fitness\+\_\+func, number\+\_\+of\+\_\+generations, gene\+\_\+type=\char`\"{}int\char`\"{}, crossover\+\_\+type=\char`\"{}single-\/point\char`\"{}, tournament\+\_\+size=3, number\+\_\+parents\+\_\+mating=2, selection\+\_\+type=\char`\"{}random-\/selection\char`\"{}, save\+\_\+best\+\_\+solutions=False, save\+\_\+solutions=False, allow\+\_\+duplicate\+\_\+gene=True, stop\+\_\+criteria\+\_\+saturate=-\/1, stop\+\_\+fitness\+\_\+target\+\_\+value=-\/1, on\+\_\+generation\+\_\+cbk=None)
\item 
def \mbox{\hyperlink{ga_8py_a57ed0d7fff1998153719dea4082f6ce0}{ga.\+visualize}} ()
\item 
def \mbox{\hyperlink{ga_8py_aefa809906f5ba47e0754b5016456649b}{ga.\+save\+\_\+to\+\_\+file}} (file)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
list \mbox{\hyperlink{ga_8py_a593514fd7d44d45e87764fc0259efe25}{ga.\+fitness\+\_\+history}} = \mbox{[}$\,$\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
libqrng -\/ library for interacting with IDQ\textquotesingle{}s Quantis Appliance \# \# Copyright (C) 2023 Sebastian Mihai Ardelean \# \# This program is free software\+: you can redistribute it and/or modify \# it under the terms of the GNU General Public License as published by \# the Free Software Foundation, either version 3 of the License, or \# (at your option) any later version. 

\# \# This program is distributed in the hope that it will be useful, \# but WITHOUT ANY WARRANTY; without even the implied warranty of \# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the \# GNU General Public License for more details. \# \# You should have received a copy of the GNU General Public License \# along with this program. If not, see \href{https://www.gnu.org/licenses/}{\texttt{ https\+://www.\+gnu.\+org/licenses/}}. \#

\# \begin{DoxyAuthor}{Author}
Sebastian Mihai Ardelean \href{mailto:sebastian.ardelean@cs.upt.ro}{\texttt{ sebastian.\+ardelean@cs.\+upt.\+ro}} \# 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
24 May 2023 \#
\end{DoxyDate}
API for interacting with IDQ\textquotesingle{}s Quantis Appliance \# 

Definition in file \mbox{\hyperlink{ga_8py_source}{ga.\+py}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{ga_8py_a990506680594f152efd0acda3b61a8ce}\label{ga_8py_a990506680594f152efd0acda3b61a8ce}} 
\index{ga.py@{ga.py}!run@{run}}
\index{run@{run}!ga.py@{ga.py}}
\doxysubsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily def ga.\+run (\begin{DoxyParamCaption}\item[{}]{chromosome\+\_\+size,  }\item[{}]{gene\+\_\+low,  }\item[{}]{gene\+\_\+high,  }\item[{}]{population\+\_\+size,  }\item[{}]{mutation\+\_\+rate,  }\item[{}]{crossover\+\_\+rate,  }\item[{}]{fitness\+\_\+func,  }\item[{}]{number\+\_\+of\+\_\+generations,  }\item[{}]{gene\+\_\+type = {\ttfamily \char`\"{}int\char`\"{}},  }\item[{}]{crossover\+\_\+type = {\ttfamily \char`\"{}single-\/point\char`\"{}},  }\item[{}]{tournament\+\_\+size = {\ttfamily 3},  }\item[{}]{number\+\_\+parents\+\_\+mating = {\ttfamily 2},  }\item[{}]{selection\+\_\+type = {\ttfamily \char`\"{}random-\/selection\char`\"{}},  }\item[{}]{save\+\_\+best\+\_\+solutions = {\ttfamily False},  }\item[{}]{save\+\_\+solutions = {\ttfamily False},  }\item[{}]{allow\+\_\+duplicate\+\_\+gene = {\ttfamily True},  }\item[{}]{stop\+\_\+criteria\+\_\+saturate = {\ttfamily -\/1},  }\item[{}]{stop\+\_\+fitness\+\_\+target\+\_\+value = {\ttfamily -\/1},  }\item[{}]{on\+\_\+generation\+\_\+cbk = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ga_8py_source_l00033}{33}} of file \mbox{\hyperlink{ga_8py_source}{ga.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00052     ): }
\DoxyCodeLine{00053  }
\DoxyCodeLine{00054     current\_generation = 0 }
\DoxyCodeLine{00055      }
\DoxyCodeLine{00056     solutions = [] }
\DoxyCodeLine{00057     best\_solutions = [] }
\DoxyCodeLine{00058     best\_solution = np.zeros(chromosome\_size, dtype=np.uint32) }
\DoxyCodeLine{00059     best\_fitness=0 }
\DoxyCodeLine{00060     old\_fitness\_value = 0 }
\DoxyCodeLine{00061     saturation\_counter = 0 }
\DoxyCodeLine{00062     num\_parents = int(population\_size / 2) }
\DoxyCodeLine{00063     num\_offsprings = population\_size -\/ num\_parents }
\DoxyCodeLine{00064      }
\DoxyCodeLine{00065  }
\DoxyCodeLine{00066     \textcolor{keyword}{def }\_\_select\_steady\_state(fitness\_values, num\_parents, population, chromosome\_size, number\_parents\_mating, tournament\_size): }
\DoxyCodeLine{00067         fitness\_sorted = sorted(range(len(fitness\_values)), key=\textcolor{keyword}{lambda} e: fitness\_values[e]) }
\DoxyCodeLine{00068         fitness\_sorted.reverse() }
\DoxyCodeLine{00069  }
\DoxyCodeLine{00070         parents = np.zeros((num\_parents, chromosome\_size), dtype=np.uint32) }
\DoxyCodeLine{00071         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(num\_parents): }
\DoxyCodeLine{00072             parents[i, :] = population[fitness\_sorted[i], :].copy() }
\DoxyCodeLine{00073         \textcolor{keywordflow}{return} parents }
\DoxyCodeLine{00074  }
\DoxyCodeLine{00075     \textcolor{keyword}{def }\_\_select\_rank(fitness\_values, num\_parents, population, chromosome\_size, number\_parents\_mating, tournament\_size): }
\DoxyCodeLine{00076         fitness\_sorted = sorted(range(len(fitness\_values)), key=\textcolor{keyword}{lambda} e: fitness\_values[e]) }
\DoxyCodeLine{00077         fitness\_sorted.reverse() }
\DoxyCodeLine{00078  }
\DoxyCodeLine{00079         parents = np.zeros((num\_parents, chromosome\_size), dtype=np.uint32) }
\DoxyCodeLine{00080         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(num\_parents): }
\DoxyCodeLine{00081             parents[i, :] = population[fitness\_sorted[i], :].copy() }
\DoxyCodeLine{00082         \textcolor{keywordflow}{return} parents }
\DoxyCodeLine{00083  }
\DoxyCodeLine{00084     \textcolor{keyword}{def }\_\_select\_random(fitness\_values, num\_parents, population, chromosome\_size, number\_parents\_mating, tournament\_size): }
\DoxyCodeLine{00085         parents = np.zeros((num\_parents, chromosome\_size), dtype=np.uint32) }
\DoxyCodeLine{00086         rand\_indices = randint(0, fitness\_values.shape[0], num\_parents) }
\DoxyCodeLine{00087  }
\DoxyCodeLine{00088         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(num\_parents): }
\DoxyCodeLine{00089             parents[i, :] = population[rand\_indices[i], :].copy() }
\DoxyCodeLine{00090         \textcolor{keywordflow}{return} parents }
\DoxyCodeLine{00091  }
\DoxyCodeLine{00092     \textcolor{keyword}{def }\_\_select\_tournament(fitness\_values, num\_parents, population, chromosome\_size, number\_parents\_mating, tournament\_size): }
\DoxyCodeLine{00093         parents = np.empty((num\_parents, chromosome\_size), dtype = np.uint32) }
\DoxyCodeLine{00094         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(num\_parents): }
\DoxyCodeLine{00095             rand\_indices = randint(0, fitness\_values.shape[0], tournament\_size) }
\DoxyCodeLine{00096             k\_fitness = fitness\_values[rand\_indices] }
\DoxyCodeLine{00097             selected\_parent\_idx = np.where(k\_fitness == np.max(k\_fitness))[0][0] }
\DoxyCodeLine{00098  }
\DoxyCodeLine{00099             parents[i, :] = population[rand\_indices[selected\_parent\_idx], :].copy() }
\DoxyCodeLine{00100         \textcolor{keywordflow}{return} parents }
\DoxyCodeLine{00101  }
\DoxyCodeLine{00102  }
\DoxyCodeLine{00103     \textcolor{keyword}{def }\_\_select\_stochastic\_universal(fitness\_values, num\_parents, population, chromosome\_size, number\_parents\_mating): }
\DoxyCodeLine{00104         fitness\_sum = np.sum(fitness\_values) }
\DoxyCodeLine{00105         \textcolor{keywordflow}{if} fitness\_sum != 0: }
\DoxyCodeLine{00106             probs = fitness\_values / fitness\_sum }
\DoxyCodeLine{00107         \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00108             probs = fitness\_values / np.finfo(np.float64).eps }
\DoxyCodeLine{00109         probs\_start = np.zeros(probs.shape, dtype=float) }
\DoxyCodeLine{00110         probs\_end = np.zeros(probs.shape, dtype=float) }
\DoxyCodeLine{00111  }
\DoxyCodeLine{00112         current = 0.0 }
\DoxyCodeLine{00113  }
\DoxyCodeLine{00114         \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(probs.shape[0]): }
\DoxyCodeLine{00115             min\_probs\_idx = np.where(probs == np.min(probs))[0][0] }
\DoxyCodeLine{00116             probs\_start[min\_probs\_idx] = current }
\DoxyCodeLine{00117             current = current + probs[min\_probs\_idx] }
\DoxyCodeLine{00118             probs\_end[min\_probs\_idx] = current }
\DoxyCodeLine{00119             probs[min\_probs\_idx] = np.iinfo(np.int64).max }
\DoxyCodeLine{00120  }
\DoxyCodeLine{00121         pointers\_distance = 1.0 / number\_parents\_mating }
\DoxyCodeLine{00122         first\_pointer = uniform(0.0, pointers\_distance, 1)[0] }
\DoxyCodeLine{00123  }
\DoxyCodeLine{00124         parents = np.zeros((num\_parents, chromosome\_size), dtype=np.uint32) }
\DoxyCodeLine{00125  }
\DoxyCodeLine{00126         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(num\_parents): }
\DoxyCodeLine{00127             rand\_pointer = first\_pointer + i * pointers\_distance }
\DoxyCodeLine{00128             \textcolor{keywordflow}{for} idx \textcolor{keywordflow}{in} range(probs.shape[0]): }
\DoxyCodeLine{00129                 \textcolor{keywordflow}{if} probs\_start[idx] <= rand\_pointer < probs\_end[idx]: }
\DoxyCodeLine{00130                     parents[i, :] = population[idx, :].copy() }
\DoxyCodeLine{00131                     \textcolor{keywordflow}{break} }
\DoxyCodeLine{00132         \textcolor{keywordflow}{return} parents }
\DoxyCodeLine{00133  }
\DoxyCodeLine{00134     \textcolor{keyword}{def }\_\_select\_roulette\_wheel(fitness\_values, num\_parents, population, chromosome\_size, number\_parents\_mating, tournament\_size): }
\DoxyCodeLine{00135         fitness\_sum = np.sum(fitness\_values) }
\DoxyCodeLine{00136         \textcolor{keywordflow}{if} fitness\_sum != 0: }
\DoxyCodeLine{00137             probs = fitness\_values / fitness\_sum }
\DoxyCodeLine{00138         \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00139             probs = fitness\_values / np.finfo(np.float64).max }
\DoxyCodeLine{00140         probs\_start = np.zeros(probs.shape, dtype=float) }
\DoxyCodeLine{00141         probs\_end = np.zeros(probs.shape, dtype=float) }
\DoxyCodeLine{00142  }
\DoxyCodeLine{00143         current = 0.0 }
\DoxyCodeLine{00144  }
\DoxyCodeLine{00145         \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(probs.shape[0]): }
\DoxyCodeLine{00146             min\_probs\_idx = np.where(probs == np.min(probs))[0][0] }
\DoxyCodeLine{00147             probs\_start[min\_probs\_idx] = current }
\DoxyCodeLine{00148             current = current + probs[min\_probs\_idx] }
\DoxyCodeLine{00149             probs\_end[min\_probs\_idx] = current }
\DoxyCodeLine{00150             probs[min\_probs\_idx] = np.iinfo(np.int64).max }
\DoxyCodeLine{00151  }
\DoxyCodeLine{00152         parents = np.zeros((num\_parents, chromosome\_size), dtype=np.uint32) }
\DoxyCodeLine{00153         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(num\_parents): }
\DoxyCodeLine{00154             rand\_prob = uniform(0.0,1.0,1)[0] }
\DoxyCodeLine{00155             \textcolor{keywordflow}{for} idx \textcolor{keywordflow}{in} range(probs.shape[0]): }
\DoxyCodeLine{00156                 \textcolor{keywordflow}{if} probs\_start[idx] <= rand\_prob < probs\_end[idx]: }
\DoxyCodeLine{00157                     parents[i, :] = population[idx, :].copy() }
\DoxyCodeLine{00158                     \textcolor{keywordflow}{break} }
\DoxyCodeLine{00159         \textcolor{keywordflow}{return} parents }
\DoxyCodeLine{00160  }
\DoxyCodeLine{00161     \textcolor{keyword}{def }\_\_crossover\_uniform(parents, num\_offsprings, chromosome\_size, crossover\_rate): }
\DoxyCodeLine{00162         offsprings = np.zeros((num\_offsprings, chromosome\_size), dtype=np.uint32) }
\DoxyCodeLine{00163         \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} range(num\_offsprings): }
\DoxyCodeLine{00164             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} (crossover\_rate \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}): }
\DoxyCodeLine{00165                 probs = uniform(0,1,parents.shape[0]).copy() }
\DoxyCodeLine{00166                 indices = np.where(probs <= crossover\_rate)[0] }
\DoxyCodeLine{00167  }
\DoxyCodeLine{00168                 \textcolor{keywordflow}{if} len(indices) == 0: }
\DoxyCodeLine{00169                     offsprings[k, :] = parents[k \% parents.shape[0], :] }
\DoxyCodeLine{00170                     \textcolor{keywordflow}{continue} }
\DoxyCodeLine{00171                 \textcolor{keywordflow}{elif} len(indices) == 1: }
\DoxyCodeLine{00172                     parent1\_idx = indices[0] }
\DoxyCodeLine{00173                     parent2\_idx = parent1\_idx }
\DoxyCodeLine{00174                 \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00175                     indices = np.random.choice(indices, 2) }
\DoxyCodeLine{00176                     parent1\_idx = indices[0] }
\DoxyCodeLine{00177                     parent2\_idx = indices[1] }
\DoxyCodeLine{00178             \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00179                 parent1\_idx = k \% parents.shape[0] }
\DoxyCodeLine{00180                 parent2\_idx = (k + 1) \% parents.shape[0] }
\DoxyCodeLine{00181  }
\DoxyCodeLine{00182  }
\DoxyCodeLine{00183             genes\_source = randint(0,2,chromosome\_size).copy() }
\DoxyCodeLine{00184             \textcolor{keywordflow}{for} gene\_idx \textcolor{keywordflow}{in} range(chromosome\_size): }
\DoxyCodeLine{00185                 \textcolor{keywordflow}{if} genes\_source[gene\_idx] == 0: }
\DoxyCodeLine{00186                     offsprings[k, gene\_idx] = parents[parent1\_idx, gene\_idx] }
\DoxyCodeLine{00187                 \textcolor{keywordflow}{elif} genes\_source[gene\_idx] == 1: }
\DoxyCodeLine{00188                     offsprings[k, gene\_idx] = parents[parent2\_idx, gene\_idx] }
\DoxyCodeLine{00189         \textcolor{keywordflow}{return} offsprings }
\DoxyCodeLine{00190  }
\DoxyCodeLine{00191     \textcolor{keyword}{def }\_\_crossover\_single\_point( parents, num\_offsprings, chromosome\_size, crossover\_rate): }
\DoxyCodeLine{00192         offsprings = np.zeros((num\_offsprings, chromosome\_size), dtype = np.uint32) }
\DoxyCodeLine{00193         \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} range(num\_offsprings): }
\DoxyCodeLine{00194             crossover\_point = randint(0, chromosome\_size, 1)[0] }
\DoxyCodeLine{00195             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} (crossover\_rate \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}): }
\DoxyCodeLine{00196                 probs = uniform(0.0, 1.0, parents.shape[0]) }
\DoxyCodeLine{00197                 indices = np.where(probs <= crossover\_rate)[0] }
\DoxyCodeLine{00198  }
\DoxyCodeLine{00199                 \textcolor{keywordflow}{if} len(indices) == 0: }
\DoxyCodeLine{00200                     offsprings[k, :] = parents[k \% parents.shape[0], :] }
\DoxyCodeLine{00201                     \textcolor{keywordflow}{continue} }
\DoxyCodeLine{00202                 \textcolor{keywordflow}{elif} len(indices) == 1: }
\DoxyCodeLine{00203                     parent1\_idx = indices[0] }
\DoxyCodeLine{00204                     parent2\_idx = parent1\_idx }
\DoxyCodeLine{00205                 \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00206                     indices = random.sample(set(indices), 2) }
\DoxyCodeLine{00207                     parent1\_idx = indices[0] }
\DoxyCodeLine{00208                     parent2\_idx = indices[1] }
\DoxyCodeLine{00209             \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00210                 parent1\_idx = k \% parents.shape[0] }
\DoxyCodeLine{00211                 parent2\_idx = (k + 1) \% parents.shape[0] }
\DoxyCodeLine{00212  }
\DoxyCodeLine{00213             offsprings[k, 0:crossover\_point] = parents[parent1\_idx, 0:crossover\_point] }
\DoxyCodeLine{00214             offsprings[k, crossover\_point:] = parents[parent2\_idx, crossover\_point:] }
\DoxyCodeLine{00215         \textcolor{keywordflow}{return} offsprings }
\DoxyCodeLine{00216  }
\DoxyCodeLine{00217     \textcolor{keyword}{def }\_\_crossover\_two\_points( parents, num\_offsprings, chromosome\_size, crossover\_rate): }
\DoxyCodeLine{00218         offsprings = np.zeros((num\_offsprings, chromosome\_size), dtype=np.uint32) }
\DoxyCodeLine{00219  }
\DoxyCodeLine{00220         \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} range(num\_offsprings): }
\DoxyCodeLine{00221             \textcolor{keywordflow}{if} parents.shape[1] == 1: }
\DoxyCodeLine{00222                 crossover\_point1 = 0 }
\DoxyCodeLine{00223             \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00224                 crossover\_point1 = randint(0, np.ceil(chromosome\_size / 2 + 1), 1)[0] }
\DoxyCodeLine{00225  }
\DoxyCodeLine{00226             crossover\_point2 = crossover\_point1 + int(chromosome\_size / 2) }
\DoxyCodeLine{00227  }
\DoxyCodeLine{00228             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} (crossover\_rate \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}): }
\DoxyCodeLine{00229                 probs = uniform(0.0, 1.0, parents.shape[0]) }
\DoxyCodeLine{00230                 indices = np.where(probs <= crossover\_rate)[0] }
\DoxyCodeLine{00231  }
\DoxyCodeLine{00232                 \textcolor{keywordflow}{if} len(indices) == 0: }
\DoxyCodeLine{00233                     offsprings[k, :] = parents[k \% parents.shape[0], :] }
\DoxyCodeLine{00234                     \textcolor{keywordflow}{continue} }
\DoxyCodeLine{00235                 \textcolor{keywordflow}{elif} len(indices) == 1: }
\DoxyCodeLine{00236                     parent1\_idx = indices[0] }
\DoxyCodeLine{00237                     parent2\_idx = parent1\_idx }
\DoxyCodeLine{00238                 \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00239                     indices = np.random.choice(indices, 2) }
\DoxyCodeLine{00240                     parent1\_idx = indices[0] }
\DoxyCodeLine{00241                     parent2\_idx = indices[1] }
\DoxyCodeLine{00242             \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00243                 parent1\_idx = k \% parents.shape[0] }
\DoxyCodeLine{00244                 parent2\_idx = (k + 1) \% parents.shape[0] }
\DoxyCodeLine{00245  }
\DoxyCodeLine{00246             offsprings[k, 0:crossover\_point1] = parents[parent1\_idx, 0:crossover\_point1] }
\DoxyCodeLine{00247  }
\DoxyCodeLine{00248             offsprings[k, crossover\_point2:] = parents[parent1\_idx, crossover\_point2:] }
\DoxyCodeLine{00249  }
\DoxyCodeLine{00250             offsprings[k, crossover\_point1:crossover\_point2] = parents[parent2\_idx, crossover\_point1:crossover\_point2] }
\DoxyCodeLine{00251  }
\DoxyCodeLine{00252         \textcolor{keywordflow}{return} offsprings }
\DoxyCodeLine{00253  }
\DoxyCodeLine{00254         }
\DoxyCodeLine{00255  }
\DoxyCodeLine{00256     \textcolor{keyword}{def }\_\_crossover\_scattered( parents, num\_offsprings, chromosome\_size, crossover\_rate): }
\DoxyCodeLine{00257         offsprings = np.zeros((num\_offsprings, chromosome\_size), dtype=np.uint32) }
\DoxyCodeLine{00258  }
\DoxyCodeLine{00259         \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} range(num\_offsprings): }
\DoxyCodeLine{00260             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} (crossover\_rate \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}): }
\DoxyCodeLine{00261                 probs = uniform(0.0, 1.0, size=parents.shape[0]) }
\DoxyCodeLine{00262                 indices = np.where(probs <= crossover\_rate)[0] }
\DoxyCodeLine{00263  }
\DoxyCodeLine{00264                 \textcolor{keywordflow}{if} len(indices) == 0: }
\DoxyCodeLine{00265                     offsprings[k, :] = parents[k \% parents.shape[0], :] }
\DoxyCodeLine{00266                     \textcolor{keywordflow}{continue} }
\DoxyCodeLine{00267                 \textcolor{keywordflow}{elif} len(indices) == 1: }
\DoxyCodeLine{00268                     parent1\_idx = indices[0] }
\DoxyCodeLine{00269                     parent2\_idx = parent1\_idx }
\DoxyCodeLine{00270                 \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00271                     indices = np.random.choice(indices, 2) }
\DoxyCodeLine{00272                     parent1\_idx = indices[0] }
\DoxyCodeLine{00273                     parent2\_idx = indices[1] }
\DoxyCodeLine{00274             \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00275                 \textcolor{comment}{\# Index of the first parent to mate. }}
\DoxyCodeLine{00276                 parent1\_idx = k \% parents.shape[0] }
\DoxyCodeLine{00277                 \textcolor{comment}{\# Index of the second parent to mate. }}
\DoxyCodeLine{00278                 parent2\_idx = (k + 1) \% parents.shape[0] }
\DoxyCodeLine{00279  }
\DoxyCodeLine{00280             gene\_sources = randint(0, 2, chromosome\_size) }
\DoxyCodeLine{00281             offsprings[k, :] = np.where(gene\_sources == 0, parents[parent1\_idx, :], parents[parent2\_idx, :]) }
\DoxyCodeLine{00282         \textcolor{keywordflow}{return} offsprings }
\DoxyCodeLine{00283  }
\DoxyCodeLine{00284     \textcolor{keyword}{def }\_\_evaluate(population, population\_size, fitness\_func): }
\DoxyCodeLine{00285         calculated\_fitness = np.zeros(population\_size,dtype=float) }
\DoxyCodeLine{00286         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(population\_size): }
\DoxyCodeLine{00287             calculated\_fitness[i] = fitness\_func(i, population[i]) }
\DoxyCodeLine{00288         \textcolor{keywordflow}{return} calculated\_fitness }
\DoxyCodeLine{00289  }
\DoxyCodeLine{00290     \textcolor{keyword}{def }\_\_mutate(offsprings, mutation\_rate): }
\DoxyCodeLine{00291         mutants = np.zeros(offsprings.shape, dtype=np.uint32) }
\DoxyCodeLine{00292         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(mutants.shape[0]): }
\DoxyCodeLine{00293             random\_value = uniform(0.0,1.0,1)[0] }
\DoxyCodeLine{00294             mutants[i, :] = offsprings[i, :] }
\DoxyCodeLine{00295             \textcolor{keywordflow}{if} random\_value > mutation\_rate: }
\DoxyCodeLine{00296                 \textcolor{keywordflow}{continue} }
\DoxyCodeLine{00297             \textcolor{comment}{\#int\_random\_value = randint(0, offsprings.shape[1] -\/ 1) }}
\DoxyCodeLine{00298     \textcolor{comment}{\#            int\_random\_value = qrand\_rand\_int(0, offsprings.shape[1] -\/ 1,1)[0] }}
\DoxyCodeLine{00299             int\_random\_value = randint(0, offsprings.shape[1] -\/ 1, 1)[0] }
\DoxyCodeLine{00300             \textcolor{keywordflow}{if} mutants[i, int\_random\_value] == 0: }
\DoxyCodeLine{00301                 mutants[i, int\_random\_value] = 1 }
\DoxyCodeLine{00302             \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00303                 mutants[i, int\_random\_value] = 0 }
\DoxyCodeLine{00304         \textcolor{keywordflow}{return} mutants }
\DoxyCodeLine{00305  }
\DoxyCodeLine{00306     crossover\_function = \_\_crossover\_single\_point }
\DoxyCodeLine{00307     \textcolor{keywordflow}{if} crossover\_type == \textcolor{stringliteral}{"{}single-\/point"{}}: }
\DoxyCodeLine{00308         crossover\_function = \_\_crossover\_single\_point }
\DoxyCodeLine{00309     \textcolor{keywordflow}{elif} crossover\_type == \textcolor{stringliteral}{"{}2-\/point"{}}: }
\DoxyCodeLine{00310         crossover\_function = \_\_crossover\_two\_points }
\DoxyCodeLine{00311     \textcolor{keywordflow}{elif} crossover\_type == \textcolor{stringliteral}{"{}uniform"{}}: }
\DoxyCodeLine{00312         crossover\_function = \_\_crossover\_uniform }
\DoxyCodeLine{00313     \textcolor{keywordflow}{elif} crossover\_type == \textcolor{stringliteral}{"{}scattered"{}}: }
\DoxyCodeLine{00314         crossover\_function = \_\_crossover\_scattered }
\DoxyCodeLine{00315     \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00316         \textcolor{keywordflow}{raise} TypeError(\textcolor{stringliteral}{"{}Crossover function does not exist."{}}) }
\DoxyCodeLine{00317  }
\DoxyCodeLine{00318     selection\_function = \_\_select\_random }
\DoxyCodeLine{00319     \textcolor{keywordflow}{if} selection\_type == \textcolor{stringliteral}{"{}steady-\/state-\/selection"{}}: }
\DoxyCodeLine{00320         selection\_function = \_\_select\_steady\_state }
\DoxyCodeLine{00321     \textcolor{keywordflow}{elif} selection\_type == \textcolor{stringliteral}{"{}rank-\/selection"{}}: }
\DoxyCodeLine{00322         selection\_function = \_\_select\_rank }
\DoxyCodeLine{00323     \textcolor{keywordflow}{elif} selection\_type == \textcolor{stringliteral}{"{}random-\/selection"{}}: }
\DoxyCodeLine{00324         selection\_function = \_\_select\_random }
\DoxyCodeLine{00325     \textcolor{keywordflow}{elif} selection\_type == \textcolor{stringliteral}{"{}tournament-\/selection"{}}: }
\DoxyCodeLine{00326         selection\_function = \_\_select\_tournament }
\DoxyCodeLine{00327     \textcolor{keywordflow}{elif} selection\_type == \textcolor{stringliteral}{"{}roulette-\/wheel-\/selection"{}}: }
\DoxyCodeLine{00328         selection\_function = \_\_select\_roulette\_wheel }
\DoxyCodeLine{00329     \textcolor{keywordflow}{elif} selection\_type == \textcolor{stringliteral}{"{}stochastic-\/universal-\/selection"{}}: }
\DoxyCodeLine{00330         selection\_function = \_\_select\_stochastic\_universal }
\DoxyCodeLine{00331     \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00332         \textcolor{keywordflow}{raise} TypeError(\textcolor{stringliteral}{"{}Selection function does not exist"{}}) }
\DoxyCodeLine{00333     \textcolor{comment}{\# create population }}
\DoxyCodeLine{00334      }
\DoxyCodeLine{00335     population = np.zeros((population\_size, chromosome\_size),dtype=np.uint32) }
\DoxyCodeLine{00336     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} range(0, population\_size): }
\DoxyCodeLine{00337         population[item] = randint(gene\_low, gene\_high,chromosome\_size).copy() }
\DoxyCodeLine{00338      }
\DoxyCodeLine{00339     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(number\_of\_generations): }
\DoxyCodeLine{00340         current\_generation = i }
\DoxyCodeLine{00341         current\_fitness = \_\_evaluate(population, population\_size,fitness\_func) }
\DoxyCodeLine{00342         best\_fitness\_index = np.argmax(current\_fitness) }
\DoxyCodeLine{00343         best\_solution = population[best\_fitness\_index, :].copy() }
\DoxyCodeLine{00344         best\_fitness = current\_fitness[best\_fitness\_index] }
\DoxyCodeLine{00345         fitness\_history.append(current\_fitness) }
\DoxyCodeLine{00346  }
\DoxyCodeLine{00347         \textcolor{keywordflow}{if} save\_best\_solutions: }
\DoxyCodeLine{00348             best\_solutions.append(best\_solution) }
\DoxyCodeLine{00349         \textcolor{keywordflow}{if} save\_solutions: }
\DoxyCodeLine{00350             solutions.append(population) }
\DoxyCodeLine{00351         \textcolor{keywordflow}{if} stop\_criteria\_saturate != -\/1: }
\DoxyCodeLine{00352             \textcolor{keywordflow}{if} old\_fitness\_value == best\_fitness: }
\DoxyCodeLine{00353                 saturation\_counter+=1 }
\DoxyCodeLine{00354             \textcolor{keywordflow}{else}: }
\DoxyCodeLine{00355                 old\_fitness\_value = best\_fitness }
\DoxyCodeLine{00356                 saturation\_counter=0 }
\DoxyCodeLine{00357             \textcolor{keywordflow}{if} saturation\_counter == stop\_criteria\_saturate: }
\DoxyCodeLine{00358                 number\_of\_generations = i+1 }
\DoxyCodeLine{00359                 \textcolor{keywordflow}{break}; }
\DoxyCodeLine{00360         \textcolor{keywordflow}{if} stop\_fitness\_target\_value != -\/1: }
\DoxyCodeLine{00361             \textcolor{keywordflow}{if} stop\_fitness\_target\_value == best\_fitness: }
\DoxyCodeLine{00362                 number\_of\_generations = i + 1 }
\DoxyCodeLine{00363                 \textcolor{keywordflow}{break}; }
\DoxyCodeLine{00364  }
\DoxyCodeLine{00365         parents = selection\_function(current\_fitness, num\_parents, population, chromosome\_size, number\_parents\_mating, tournament\_size) }
\DoxyCodeLine{00366         offsprings = crossover\_function(parents, num\_offsprings, chromosome\_size, crossover\_rate) }
\DoxyCodeLine{00367         mutants = \_\_mutate(offsprings, mutation\_rate) }
\DoxyCodeLine{00368         population[0:parents.shape[0], :] = parents }
\DoxyCodeLine{00369         population[parents.shape[0]:, :] = mutants }
\DoxyCodeLine{00370         \textcolor{keywordflow}{if} on\_generation\_cbk \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}: }
\DoxyCodeLine{00371             ret\_value = on\_generation\_cbk(current\_generation, best\_solution, best\_fitness) }
\DoxyCodeLine{00372             \textcolor{keywordflow}{if} ret\_value != 0: }
\DoxyCodeLine{00373                 number\_of\_generations = i + 1 }
\DoxyCodeLine{00374                 \textcolor{keywordflow}{break} }
\DoxyCodeLine{00375  }
\DoxyCodeLine{00376     fitness\_last\_gen = \_\_evaluate(population, population\_size,fitness\_func) }
\DoxyCodeLine{00377     best\_fitness\_index = np.argmax(fitness\_last\_gen) }
\DoxyCodeLine{00378     best\_solution = population[best\_fitness\_index, :].copy() }
\DoxyCodeLine{00379     best\_fitness = fitness\_last\_gen[best\_fitness\_index] }
\DoxyCodeLine{00380  }
\DoxyCodeLine{00381     \textcolor{comment}{\#print('Last generation: \(\backslash\)n\{\}\(\backslash\)n'.format(population)) }}
\DoxyCodeLine{00382     \textcolor{keywordflow}{return} best\_solution, best\_fitness }
\DoxyCodeLine{00383  }
\DoxyCodeLine{00384  }

\end{DoxyCode}
\mbox{\Hypertarget{ga_8py_aefa809906f5ba47e0754b5016456649b}\label{ga_8py_aefa809906f5ba47e0754b5016456649b}} 
\index{ga.py@{ga.py}!save\_to\_file@{save\_to\_file}}
\index{save\_to\_file@{save\_to\_file}!ga.py@{ga.py}}
\doxysubsubsection{\texorpdfstring{save\_to\_file()}{save\_to\_file()}}
{\footnotesize\ttfamily def ga.\+save\+\_\+to\+\_\+file (\begin{DoxyParamCaption}\item[{}]{file }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ga_8py_source_l00397}{397}} of file \mbox{\hyperlink{ga_8py_source}{ga.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00397 \textcolor{keyword}{def }save\_to\_file(file): }
\DoxyCodeLine{00398     number\_of\_generations = len(fitness\_history) }
\DoxyCodeLine{00399     fitness\_history\_mean = [np.mean(fitness\_value) \textcolor{keywordflow}{for} fitness\_value \textcolor{keywordflow}{in} fitness\_history] }
\DoxyCodeLine{00400     fitness\_history\_max = [np.max(fitness\_value) \textcolor{keywordflow}{for} fitness\_value \textcolor{keywordflow}{in} fitness\_history] }
\DoxyCodeLine{00401     \textcolor{keyword}{with} open(file, \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} f: }
\DoxyCodeLine{00402         f.write(f\textcolor{stringliteral}{'Number of generations:\{number\_of\_generations\}'}) }
\DoxyCodeLine{00403         f.write(\textcolor{stringliteral}{'\(\backslash\)n'}) }
\DoxyCodeLine{00404         f.write(f\textcolor{stringliteral}{'Fitness history mean:\{fitness\_history\_mean\}'}) }
\DoxyCodeLine{00405         f.write(\textcolor{stringliteral}{'\(\backslash\)n'}) }
\DoxyCodeLine{00406         f.write(f\textcolor{stringliteral}{'Fitness history max:\{fitness\_history\_max\}}}

\end{DoxyCode}
\mbox{\Hypertarget{ga_8py_a57ed0d7fff1998153719dea4082f6ce0}\label{ga_8py_a57ed0d7fff1998153719dea4082f6ce0}} 
\index{ga.py@{ga.py}!visualize@{visualize}}
\index{visualize@{visualize}!ga.py@{ga.py}}
\doxysubsubsection{\texorpdfstring{visualize()}{visualize()}}
{\footnotesize\ttfamily def ga.\+visualize (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ga_8py_source_l00385}{385}} of file \mbox{\hyperlink{ga_8py_source}{ga.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00385 \textcolor{keyword}{def }visualize(): }
\DoxyCodeLine{00386     number\_of\_generations = len(fitness\_history) }
\DoxyCodeLine{00387     fitness\_history\_mean = [np.mean(fitness\_value) \textcolor{keywordflow}{for} fitness\_value \textcolor{keywordflow}{in} fitness\_history] }
\DoxyCodeLine{00388     fitness\_history\_max = [np.max(fitness\_value) \textcolor{keywordflow}{for} fitness\_value \textcolor{keywordflow}{in} fitness\_history] }
\DoxyCodeLine{00389     plt.plot(list(range(number\_of\_generations)), fitness\_history\_mean, label=\textcolor{stringliteral}{'Mean Fitness'}) }
\DoxyCodeLine{00390     plt.plot(list(range(number\_of\_generations)), fitness\_history\_max, label=\textcolor{stringliteral}{'Max Fitness'}) }
\DoxyCodeLine{00391     plt.legend() }
\DoxyCodeLine{00392     plt.xlabel(\textcolor{stringliteral}{'Generations'}) }
\DoxyCodeLine{00393     plt.ylabel(\textcolor{stringliteral}{'Fitness'}) }
\DoxyCodeLine{00394     plt.savefig(\textcolor{stringliteral}{"{}Figure\_2.png"{}}) }
\DoxyCodeLine{00395     plt.show() }
\DoxyCodeLine{00396  }

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{ga_8py_a593514fd7d44d45e87764fc0259efe25}\label{ga_8py_a593514fd7d44d45e87764fc0259efe25}} 
\index{ga.py@{ga.py}!fitness\_history@{fitness\_history}}
\index{fitness\_history@{fitness\_history}!ga.py@{ga.py}}
\doxysubsubsection{\texorpdfstring{fitness\_history}{fitness\_history}}
{\footnotesize\ttfamily list ga.\+fitness\+\_\+history = \mbox{[}$\,$\mbox{]}}



Definition at line \mbox{\hyperlink{ga_8py_source_l00031}{31}} of file \mbox{\hyperlink{ga_8py_source}{ga.\+py}}.

